[![License](https://img.shields.io/badge/license-MIT%2FApache-blue.svg)](https://github.com/IvoryDuke/HillVacuum#license)

## What is Hill Vacuum?
Hill Vacuum is a Doom Builder and Trenchbroom inspired editor that allows the creation of bidimensional maps through the manipulation of convex polygons, placement of items and entities, and texture mapping.

## Why is Hill Vacuum?
- I wanted to learn Rust;
- I wanted to create my editor;
- I got tired of manually typing the coordinates of the collision polygons in a text file.

## How is Hill Vacuum?
For those who do not mind reading, HV features a built in manual which can be opened through the keyboard key ~.
For the rest, there's this video

## Keywords
### Brushes
Brushes are convex polygonal surfaces. They can have an associated texture which can either be drawn filling their area or as a sprite. The sprite can be displaced independently of the brush surface.
Brushes can also be assigned a path that describes how it moves in the bidimensional space and that can be edited with the Path tool.
Finally, brushes can either represent a clipping surface or not by changing the collision setting in the bottom left area of the UI.

### Things
Things are objects which can be placed around the map. They area characterized by an ID, a width and height, a name, and a texture which represents them.
Things can either be defined in one or many .ini files to be placed in the assets/things/ folder or, if Hill Vacuum is used as a library, implementing the MapThing interface for the structs representing an object to be placed in the map and using the "hardcoded_things" macro to insert them in the bevy App.
If defined in the .ini files, the things must follow a similar format:
```ini
[Name]
width = N
height = M
id = ID
preview = TEX
```
Where N and M represent the sizes of the thing's bounding box, ID is a unique identifier between 0 and 65534, and TEX is the name of the texture to be drawn along with the bounding box.
If a thing defined through the MapThing interface has the same ID as one loaded from file, the latter will overwrite the former.
Things can be reloaded while the application is running through the UI button in the Options menu.

### Textures
Textures must be placed in the assets/textures/ folder to be loaded.
The texture editor can be opened at any time to edit the parameters of the textures of the selected brushes.
Entity, scale, and rotate tool also feature texture editing capabilities. These capabilities can be either enabled through the dedicated "Target" UI element in the bottom left area, or by pressing Alt + texture editor bind.
Textures can have an associated animation which can either consist of a list of textures to display, each one for a specific time, or an atlas of textures generated by subdividing the textures in subareas. The animations can be applied to the texture as a default or to the texture of the selected brushes only.
Textures can be reloaded while the application is running through the UI button in the Options menu.
Default textures animation can be exported and imported between map files. The file extension of the animations files is .anms.

### Props
A prop is a collection of entities which can be painted around the map like the brushes of a image editing tool.
Each prop has a pivot, the point relative to which the it is painted onto the map.
Props can be imported and exported between map files. The file extension of the props files is .prps.

## File formats
HV creates three types of files, all of which are relatively simple:
- .hv is the regular map files;
```
------------------------
| Header (4 usize)     |
| brushes amount       |
| things amount        |
| animations amount    |
| props amount         |
------------------------
| Animations           |
------------------------
| Brushes              |
------------------------
| Things               |
------------------------
| Props                |
------------------------
```
- .anms is the "animations only" file, which can be used to exchange animations between maps;
```
-----------------------------
| animations amount (usize) |
-----------------------------
| Animations                |
-----------------------------
```
- .prps is the "props only" file, which can be used to exchange props between maps;
```
------------------------
| props amount (usize) |
------------------------
| Props                |
------------------------
```

## Getting started
HV can be compiled as a standalone executable simply compiling the source code (Linux distributions may require the installation of extra libraries).
```sh
cargo run
```

Otherwise it can be integrated in your own project as such:
```rust
fn main()
{
    bevy::prelude::App::new()
        .add_plugins(hill_vacuum::HillVacuumPlugin)
        .run();
}
```

Map files can be read through the Exporter struct that will return lists of all the brushes and things, which can then be exported as desired.
Assuming the path of the map file was passed as an argument to the exporting executable the code will look something like this:
```rust
fn main()
{
    let exporter = hill_vacuum::Exporter::new(&std::env::args().collect::<Vec<_>>()[0]);
    // Your code.
}
```
The map being edited can be exported through such an executable through the File->Export command in the editor.
The executable can be picked through Options->Exporter.

## Features
- `debug`: enables dynamic linking for faster compile times and some debug lines of the editor;
- `arena_alloc`: enables the usage of an arena allocator for fast allocation times. Requires nightly compiler.

## FAQ
### It's "vertices", not "vertexes"
First of all https://dictionary.cambridge.org/dictionary/english/vertexes
Finally, "if popular culture has taught us anything is that vowels are not extreme" (https://youtu.be/mols06iqcfA?si=ijCNCojPOR4rC8n1&t=336).

### Actually if you read the "Rust programming language" book it clearly says: "Itâ€™s good style to place the opening curly bracket on the same line as the function declaration, adding one space in between."
There's a lot of talk around the internet about respecting each other's differences, and rightfully so. So I would appreciate it if people could respect this difference of mine.
